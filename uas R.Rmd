---
title: "uas R"
author: "Kelompok 1"
date: "2023-12-19"
output: html_document
---

## Library
```{r}
library(dplyr)
library(ggplot2)
library(caret)
library(tidyverse)
library(psych) #Untuk melihat data normal
library(moments) #Untuk menghitung Pearson Kurtosis, Geary Skewness
library(outliers) #Untuk mendeteksi outliers
library(Metrics)
library(randomForest)
```


## Loading Dataset
```{r}
admisi = read.csv('admisi.csv', header = TRUE, sep = ";")
profiling = read.csv('profiling.csv', header = TRUE, sep = ";")

# Menggabungkan dataset berdasarkan kolom ID
newdata = merge(profiling, admisi, by = "ID")
newdata
```

sum(is.na(newdata$IPK))

## DATA PREPROCESSING
```{r}

# Menghitung modus
modus_jenkel = names(sort(table(newdata$JENIS_KEL), decreasing = TRUE)[1])
modus_riset = names(sort(table(newdata$RISET), decreasing = TRUE)[1])
modus_lulus = names(sort(table(newdata$LULUS), decreasing = TRUE)[1])

# Mengganti nilai NA dengan modus
newdata$JENIS_KEL[is.na(newdata$JENIS_KEL)] = modus_jenkel
newdata$RISET[is.na(newdata$RISET)] = modus_riset
newdata$LULUS[is.na(newdata$LULUS)] = modus_lulus

# Transformasi faktor
newdata$JENIS_KEL = as.factor(newdata$JENIS_KEL)
newdata$LULUS = factor(newdata$LULUS, levels = c(1, 0), labels = c('Lulus', 'Tidak Lulus'))
newdata$RISET = as.factor(newdata$RISET)

# Mengganti koma (,) dengan titik (.) pada kolom "IPK"
newdata$IPK = gsub(",", ".", newdata$IPK)
newdata$MOT_LETTER = gsub(",", ".", newdata$MOT_LETTER)
newdata$REKOM_LETTER <- gsub(",", ".", newdata$REKOM_LETTER)

# Mengganti nilai NA pada nilai non-numerik
newdata$IPK = as.numeric(newdata$IPK)
newdata$MOT_LETTER = as.numeric(newdata$MOT_LETTER)
newdata$REKOM_LETTER = as.numeric(newdata$REKOM_LETTER)

# Menghitung mean
mean_rank = mean(newdata$Ranking_Uni_Asal, na.rm = TRUE)
mean_motl = mean(newdata$MOT_LETTER, na.rm = TRUE)
mean_koml = mean(newdata$REKOM_LETTER, na.rm = TRUE)

# Mengganti nilai NA dengan mean
newdata$Ranking_Uni_Asal[is.na(newdata$Ranking_Uni_Asal)] = mean_rank
newdata$MOT_LETTER[is.na(newdata$MOT_LETTER)] = mean_motl
newdata$REKOM_LETTER[is.na(newdata$REKOM_LETTER)] = mean_koml

str(newdata)
```

## MENGECEK DAN HAPUS OUTLIER

```{r}

# Loop untuk menampilkan boxplot satu per satu untuk variabel numerik
for (col in names(newdata)) {
  if (is.numeric(newdata[[col]])) {
    boxplot(newdata[[col]], main = col)
  }
}

# Menghapus Outliers
IQR_ipk = IQR(newdata$IPK)
upfen_ipk = quantile(newdata$IPK, 0.75) + 1.5 * IQR_ipk

IQR_koml = IQR(newdata$REKOM_LETTER)
lowfen_koml = quantile(newdata$REKOM_LETTER, 0.25) - 1.5 * IQR_koml

clean_newdata = subset(newdata, newdata$IPK <= upfen_ipk & newdata$REKOM_LETTER >= lowfen_koml)

# Mengecek apakah masih terdapat outliers
for (col in names(clean_newdata)) {
  if (is.numeric(clean_newdata[[col]])) {
    boxplot(clean_newdata[[col]], main = col)
  }
}

```

